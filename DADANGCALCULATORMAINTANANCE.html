<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Maintenance Support â€“ DADANG WAHYUONO</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

  <style>
    :root{
      --bg:#020617;
      --card:#020617;
      --border:#1f2937;
      --accent:#22c55e;
      --accent-soft:rgba(34,197,94,.12);
      --accent-blue:#3b82f6;
      --text-main:#f9fafb;
      --text-sub:#9ca3af;
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    body{
      font-family:"Inter",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      min-height:100vh;
      background:#020617;
      color:var(--text-main);
      display:flex;
      justify-content:center;
      padding:18px;
    }
    .app{
      width:100%;
      max-width:1200px;
      background:radial-gradient(circle at 0 0,#0b1120 0,#020617 55%,#020617 100%);
      border-radius:24px;
      border:1px solid rgba(148,163,184,.4);
      box-shadow:0 24px 80px rgba(15,23,42,.9);
      padding:18px 18px 14px;
      position:relative;
      overflow:hidden;
    }
    .glow{
      position:absolute;
      inset:-40%;
      background:
        radial-gradient(circle at 10% 0%,rgba(59,130,246,.25),transparent 60%),
        radial-gradient(circle at 90% 20%,rgba(34,197,94,.25),transparent 55%);
      opacity:.45;
      pointer-events:none;
      z-index:-1;
    }
    .header{
      display:flex;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      align-items:flex-start;
      margin-bottom:10px;
    }
    .logo-wrap{
      display:flex;
      align-items:center;
      gap:10px;
    }
    #logoPreview{
      height:56px;
      max-height:56px;
      width:auto;
      max-width:150px;
      border-radius:14px;
      border:1px solid rgba(148,163,184,.5);
      background:#020617;
      object-fit:contain;
      padding:4px;
    }
    .logo-upload label{
      font-size:10px;
      display:inline-block;
      margin-bottom:3px;
      text-transform:uppercase;
      letter-spacing:.08em;
      color:var(--text-sub);
    }
    .logo-upload input{
      font-size:10px;
      color:var(--text-sub);
    }
    .title h1{
      font-size:18px;
      font-weight:600;
      letter-spacing:.08em;
      text-transform:uppercase;
    }
    .badge{
      font-size:10px;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid rgba(34,197,94,.85);
      background:var(--accent-soft);
      color:var(--accent);
      letter-spacing:.09em;
      text-transform:uppercase;
      margin-left:8px;
    }
    .author{
      font-size:11px;
      color:#e5e7eb;
      margin-top:4px;
    }
    .author span{
      font-weight:600;
      color:#a5b4fc;
    }
    .subline{
      font-size:11px;
      color:var(--text-sub);
      margin-top:2px;
    }
    .pill{
      border-radius:999px;
      border:1px solid rgba(148,163,184,.5);
      font-size:11px;
      padding:7px 11px;
      color:var(--text-sub);
      display:inline-flex;
      align-items:center;
      gap:6px;
      background:rgba(15,23,42,.98);
    }
    .pill-dot{
      width:7px;
      height:7px;
      border-radius:999px;
      background:var(--accent);
      box-shadow:0 0 14px rgba(34,197,94,.9);
    }

    /* TABS */
    .tabs{
      display:flex;
      gap:6px;
      margin-bottom:10px;
      border-bottom:1px solid rgba(31,41,55,.9);
    }
    .tab-btn{
      font-size:11px;
      padding:6px 10px;
      border-radius:999px 999px 0 0;
      border:1px solid transparent;
      border-bottom:none;
      background:transparent;
      color:var(--text-sub);
      cursor:pointer;
    }
    .tab-btn.active{
      border-color:rgba(148,163,184,.8);
      border-bottom-color:#020617;
      background:rgba(15,23,42,.95);
      color:#e5e7eb;
    }
    .tab-content{display:none;}
    .tab-content.active{display:block;}

    .layout{
      display:grid;
      grid-template-columns:minmax(0,1.05fr) minmax(0,1.2fr);
      gap:15px;
    }
    @media(max-width:900px){
      .layout{grid-template-columns:minmax(0,1fr);}
      body{padding:10px;}
    }
    .card{
      background:rgba(15,23,42,.97);
      border-radius:18px;
      border:1px solid rgba(31,41,55,.96);
      padding:11px 11px 9px;
      margin-bottom:8px;
      backdrop-filter:blur(18px);
    }
    .card-header{
      display:flex;
      justify-content:space-between;
      gap:8px;
      align-items:center;
      margin-bottom:7px;
    }
    .card-title{
      font-size:12px;
      font-weight:600;
      letter-spacing:.08em;
      text-transform:uppercase;
      color:#e5e7eb;
    }
    .card-sub{
      font-size:11px;
      color:var(--text-sub);
      margin-top:2px;
    }
    .tag{
      font-size:10px;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.6);
      letter-spacing:.08em;
      text-transform:uppercase;
      color:var(--text-sub);
      white-space:nowrap;
    }
    .field{
      display:flex;
      flex-direction:column;
      gap:3px;
      margin-bottom:6px;
    }
    label{
      font-size:10px;
      font-weight:500;
      text-transform:uppercase;
      letter-spacing:.06em;
      color:#e5e7eb;
    }
    .hint{
      font-size:10px;
      color:var(--text-sub);
    }
    .input-wrap{position:relative;}
    input,select,textarea{font-family:inherit;}
    input,select,textarea{
      width:100%;
      background:#020617;
      border-radius:10px;
      border:1px solid #1f2937;
      padding:7px 9px;
      padding-right:30px;
      font-size:11px;
      color:var(--text-main);
      outline:none;
    }
    input::placeholder,textarea::placeholder{
      color:#6b7280;
    }
    input:focus,select:focus,textarea:focus{
      border-color:rgba(34,197,94,.9);
      box-shadow:0 0 0 1px rgba(34,197,94,.5);
    }
    select{padding-right:24px;}
    .suffix{
      position:absolute;
      right:8px;
      top:50%;
      transform:translateY(-50%);
      font-size:9px;
      color:#6b7280;
      pointer-events:none;
    }
    .mode-toggle{
      display:flex;
      gap:6px;
      margin-bottom:6px;
    }
    .mode-btn{
      flex:1;
      font-size:11px;
      padding:6px 8px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.6);
      background:#020617;
      color:var(--text-sub);
      cursor:pointer;
    }
    .mode-btn.active{
      border-color:var(--accent);
      color:#bbf7d0;
      background:rgba(34,197,94,.12);
    }
    .results-main{
      background:radial-gradient(circle at top left,rgba(34,197,94,.12),rgba(15,23,42,.98));
      border-radius:14px;
      border:1px solid rgba(34,197,94,.7);
      padding:9px 10px 10px;
      margin-bottom:8px;
    }
    .results-main.blue{
      background:radial-gradient(circle at top left,rgba(59,130,246,.15),rgba(15,23,42,.98));
      border-color:rgba(59,130,246,.7);
    }
    .result-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
    }
    .label-main{
      font-size:10px;
      letter-spacing:.11em;
      text-transform:uppercase;
      color:#bbf7d0;
    }
    .value-main{
      font-size:22px;
      font-weight:700;
      margin-top:3px;
      color:#bbf7d0;
    }
    .value-main span{
      font-size:11px;
      margin-left:4px;
      opacity:.9;
    }
    .chip{
      font-size:10px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(34,197,94,.7);
      color:#bbf7d0;
      background:rgba(15,23,42,.96);
      white-space:nowrap;
    }
    .chip.blue{
      border-color:rgba(59,130,246,.7);
      color:#bfdbfe;
    }
    .metric-grid{
      display:grid;
      grid-template-columns:repeat(2,minmax(0,1fr));
      gap:7px;
      margin-top:8px;
    }
    .metric-label{
      font-size:10px;
      text-transform:uppercase;
      letter-spacing:.08em;
      color:var(--text-sub);
    }
    .metric-value{
      font-size:14px;
      margin-top:2px;
      font-weight:600;
    }
    .metric-value span{
      font-size:10px;
      margin-left:4px;
      color:var(--text-sub);
    }
    table{
      width:100%;
      border-collapse:collapse;
      font-size:12px;
      margin-top:4px;
    }
    th,td{
      padding:5px 6px;
      border-bottom:1px solid rgba(31,41,55,.95);
      text-align:left;
    }
    th{
      font-size:10px;
      font-weight:500;
      color:var(--text-sub);
      text-transform:uppercase;
      letter-spacing:.06em;
    }
    tr:last-child td{border-bottom:none;}
    .num{text-align:right;}
    textarea{
      min-height:110px;
      resize:vertical;
    }
    .footer{
      margin-top:6px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      font-size:10px;
      color:var(--text-sub);
      align-items:center;
    }
    .btn{
      font-size:11px;
      padding:5px 9px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.6);
      background:#020617;
      color:var(--text-main);
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .btn:hover{border-color:var(--accent);}
    .note{
      font-size:11px;
      margin-top:6px;
      color:var(--accent);
    }
    .signature{
      margin-top:16px;
      border-top:1px dashed rgba(75,85,99,.8);
      padding-top:10px;
      display:flex;
      justify-content:space-between;
      align-items:flex-end;
      gap:12px;
      font-size:11px;
      color:var(--text-sub);
    }
    .sig-name{
      margin-top:40px;
      font-weight:600;
      font-size:12px;
      color:#e5e7eb;
      border-top:1px solid rgba(148,163,184,.7);
      display:inline-block;
      padding-top:4px;
      min-width:180px;
    }
    .sig-title{
      font-size:11px;
      margin-top:2px;
    }
    .pdf-hint{
      font-size:10px;
      color:var(--text-sub);
      margin-top:4px;
      max-width:340px;
    }

    .no-print{}
    .print-only{display:none;}

    /* Tabel CPK page */
    .cpk-page-card{
      background:rgba(15,23,42,.97);
      border-radius:18px;
      border:1px solid rgba(31,41,55,.96);
      padding:11px 11px 11px;
      margin-bottom:4px;
    }
    .cpk-table{
      width:100%;
      border-collapse:collapse;
      font-size:11px;
      margin-top:6px;
    }
    .cpk-table th,
    .cpk-table td{
      border:1px solid #1f2937;
      padding:4px 6px;
    }
    .cpk-table th{
      background:#020617;
      color:var(--text-sub);
      text-transform:uppercase;
      letter-spacing:.06em;
      font-size:10px;
    }
    .cpk-table tr:nth-child(even) td{
      background:rgba(15,23,42,.9);
    }

    @page{
      margin:8mm;
    }
    @media print{
      body{
        background:#fff;
        padding:0;
        margin:0;
        zoom:0.78;
      }
      .app{
        max-width:100%;
        border-radius:0;
        border:none;
        box-shadow:none;
        padding:4mm 6mm;
        background:#fff;
        color:#000;
        margin:0 auto;
      }
      .glow{display:none;}
      .pill,.logo-upload,.btn,#copyBtn,#waText,
      .footer > div:first-child,
      .hint,input,select,textarea,
      .no-print,
      .tabs,
      #tab-cpk{
        display:none!important;
      }
      .print-only{display:block!important;}
      .layout{display:block;}
      .card{
        background:#fff;
        border-color:#e5e7eb;
        page-break-inside:avoid;
        margin-bottom:4mm;
      }
      .card-title{color:#111827;font-size:13px;}
      .card-sub,.metric-label,.pdf-hint{color:#374151;}
      .metric-value{color:#111827;}
      .value-main{color:#111827;}
      th{color:#111827;}
      td{color:#111827;}
      .badge{
        border-color:#0f172a;
        color:#0f172a;
        background:#e5e7eb;
      }
      .author span{color:#111827;}
      .signature{border-top-color:#e5e7eb;margin-top:4mm;}
      .sig-name{
        border-top-color:#9ca3af;
        color:#111827;
      }
      .pdf-hint{color:#111827;}
      .header{margin-bottom:3mm;}
    }
  </style>
</head>
<body>
<div class="app">
  <div class="glow"></div>

  <!-- HEADER -->
  <div class="header">
    <div class="logo-wrap">
      <img id="logoPreview" alt="Logo perusahaan" />
      <div class="logo-upload">
        <label for="logoInput">Upload Logo</label>
        <input id="logoInput" type="file" accept="image/*">
      </div>
    </div>
    <div class="title">
      <h1>
        MAINTENANCE SUPPORT CALCULATOR
        <span class="badge">SERVICE &amp; BAN â€¢ CPK</span>
      </h1>
      <div class="author">
        Disusun oleh: <span>DADANG WAHYUONO</span> â€” Maintenance &amp; Logistic Support
      </div>
      <div class="subline">
        Batas internal: biaya maintenance per tahun idealnya â‰¤ 1% dari harga OTR.
      </div>
      <div class="print-only" style="margin-top:6px;">
        <div class="metric-label">Data unit (untuk dokumen)</div>
        <div class="metric-value" id="headerUnitInfo">Unit: - â€¢ OTR: Rp 0</div>
      </div>
    </div>
    <div>
      <div class="pill">
        <span class="pill-dot"></span>
        Normal â€¢ Medium â€¢ High â€¢ Very High (by kategori)
      </div>
    </div>
  </div>

  <!-- TABS -->
  <div class="tabs no-print">
    <button type="button" class="tab-btn active" data-tab="calc">Calculator</button>
    <button type="button" class="tab-btn" data-tab="cpk">Tabel CPK Industri</button>
  </div>

  <!-- TAB 1: CALCULATOR -->
  <div id="tab-calc" class="tab-content active">
    <div class="layout">
      <!-- KIRI: INPUT -->
      <div class="no-print">
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Mode Perhitungan</div>
              <div class="card-sub">Unit Baru (CPK kategori) atau Used Car (ODO aktual).</div>
            </div>
            <div class="tag">Mode</div>
          </div>
          <div class="mode-toggle">
            <button type="button" class="mode-btn active" id="modeNewBtn">Unit Baru (Auto CPK)</button>
            <button type="button" class="mode-btn" id="modeUsedBtn">Used Car (ODO)</button>
          </div>
          <div class="field">
            <label for="duration">Durasi Kontrak</label>
            <div class="input-wrap">
              <select id="duration">
                <option value="1">1 tahun</option>
                <option value="2">2 tahun</option>
                <option value="3" selected>3 tahun</option>
                <option value="4">4 tahun</option>
                <option value="5">5 tahun</option>
              </select>
            </div>
            <div class="hint">Dipakai untuk total KM, total ban, dan total biaya maintenance.</div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Data Unit & Kontrak</div>
              <div class="card-sub">Wajib: pilih kategori & isi OTR, baru kalkulasi muncul.</div>
            </div>
            <div class="tag">Unit</div>
          </div>

          <div class="field">
            <label for="unitName">Nama Unit</label>
            <div class="input-wrap">
              <input id="unitName" type="text" placeholder="Contoh: Avanza 1.3 G / Innova Reborn / Fuso FN 517">
            </div>
          </div>

          <div class="field">
            <label for="otr">Harga OTR Unit</label>
            <div class="input-wrap">
              <input id="otr" type="number" placeholder="Contoh: 300000000">
              <span class="suffix">Rp</span>
            </div>
            <div class="hint">Batas maintenance internal = Â±1% OTR per tahun.</div>
          </div>

          <div class="field">
            <label for="projectValue">Nilai Project Total</label>
            <div class="input-wrap">
              <input id="projectValue" type="number" placeholder="Opsional: nilai kontrak total (semua tahun)">
              <span class="suffix">Rp</span>
            </div>
          </div>

          <div class="field">
            <label for="category">Kategori Unit</label>
            <div class="input-wrap">
              <select id="category">
                <option value="">Pilih kategori unit...</option>
                <option value="lcgc">LCGC / Hatchback (Ayla, Agya, Brio)</option>
                <option value="mpv_kecil">MPV KECIL (Avanza/Xenia/LCGC)</option>
                <option value="mpv_suv">MPV MEDIUM / SUV (Innova/Fortuner)</option>
                <option value="pickup">PICKUP / DOUBLE CABIN</option>
                <option value="light_truck">LIGHT TRUCK (Engkel)</option>
                <option value="medium_truck">MEDIUM TRUCK</option>
                <option value="heavy_truck">HEAVY TRUCK / TRONTON</option>
              </select>
            </div>
            <div class="hint">CPK Normal/Medium/High/Very High otomatis mengikuti kategori.</div>
          </div>

          <div class="field">
            <label for="tirePrice">Harga Ban / pcs</label>
            <div class="input-wrap">
              <input id="tirePrice" type="number" placeholder="Kosongkan = default per kategori">
              <span class="suffix">Rp/ban</span>
            </div>
          </div>

          <div class="field">
            <label for="tireQty">Jumlah Ban Kendaraan</label>
            <div class="input-wrap">
              <input id="tireQty" type="number" placeholder="4">
              <span class="suffix">pcs</span>
            </div>
            <div class="hint">Informasi saja (MPV=4, engkel=6, Fuso=10). Konsumsi ban dihitung 1 pcs per 50.000 km.</div>
          </div>
        </div>

        <div class="card" id="newInputBlock">
          <div class="card-header">
            <div>
              <div class="card-title">Unit Baru â€“ CPK Otomatis & KM/Tahun</div>
              <div class="card-sub">Kalau KM/tahun kosong â†’ asumsi normal 20.000 km/tahun.</div>
            </div>
            <div class="tag">New</div>
          </div>

          <div class="field">
            <label for="kmYearNew">KM/Tahun (Estimasi)</label>
            <div class="input-wrap">
              <input id="kmYearNew" type="number" placeholder="Kosongkan = 20000 (â‰ˆ55 km/hari)">
              <span class="suffix">km/thn</span>
            </div>
          </div>

          <div class="note">
            Service/tahun = CPK level Ã— KM/tahun. Ban/tahun = KM/tahun Ã· 50.000 Ã— harga ban.
            Level: Normal Ã—1.0 â€¢ Medium Ã—1.2 â€¢ High Ã—1.5 â€¢ Very High Ã—2.0.
          </div>
        </div>

        <div class="card" id="usedInputBlock" style="display:none;">
          <div class="card-header">
            <div>
              <div class="card-title">Used Car â€“ ODO & CPK Rekomendasi</div>
              <div class="card-sub">Hitung km/tahun dari ODO & umur unit, lalu pakai CPK kategori.</div>
            </div>
            <div class="tag">Used</div>
          </div>

          <div class="field">
            <label for="odo">Odometer Sekarang</label>
            <div class="input-wrap">
              <input id="odo" type="number" placeholder="Contoh: 40000">
              <span class="suffix">km</span>
            </div>
          </div>

          <div class="field">
            <label for="unitAge">Umur Unit (Pemakaian)</label>
            <div class="input-wrap">
              <input id="unitAge" type="number" placeholder="Contoh: 2">
              <span class="suffix">tahun</span>
            </div>
          </div>

          <div class="note">
            Engine akan hitung km/tahun = ODO Ã· umur, tentukan level pemakaian (Normalâ€“Very High),
            lalu hitung biaya rekomendasi berbasis CPK kategori + ban.
          </div>
        </div>
      </div>

      <!-- KANAN: OUTPUT -->
      <div>
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Ringkasan Tahunan & Kontrak</div>
              <div class="card-sub">Service, ban, KM & porsi biaya terhadap OTR / nilai project.</div>
            </div>
            <div class="tag">Core</div>
          </div>

          <div class="results-main">
            <div class="result-header">
              <div>
                <div class="label-main">Mode Aktif</div>
                <div class="value-main" id="modeLabel">-<span>Pilih kategori & isi OTR</span></div>
              </div>
              <div class="chip" id="kmInfoChip">KM/tahun: -</div>
            </div>

            <div style="margin-top:6px;">
              <div class="metric-label">Data unit (untuk dokumen)</div>
              <div class="metric-value" id="pdfUnitInfo">Unit: - â€¢ OTR: Rp 0</div>
            </div>

            <div class="metric-grid">
              <div>
                <div class="metric-label">Biaya service / tahun</div>
                <div class="metric-value" id="svcCostInfo">Rp 0<span>/thn (Normal)</span></div>
              </div>
              <div>
                <div class="metric-label">Ban / tahun</div>
                <div class="metric-value" id="tireInfo">0.00 pcs â€¢ Rp 0<span>/thn</span></div>
              </div>
              <div>
                <div class="metric-label">Total maint. / tahun</div>
                <div class="metric-value" id="totalYearInfo">Rp 0<span>/thn (Normal)</span></div>
              </div>
              <div>
                <div class="metric-label">CPK total (service+ban)</div>
                <div class="metric-value" id="cpkResultInfo">-<span>Rp/km (Normal)</span></div>
              </div>
            </div>

            <div class="metric-grid" style="margin-top:10px;">
              <div>
                <div class="metric-label">Total KM kontrak</div>
                <div class="metric-value" id="totalKmDurationInfo">0 km<span>/kontrak</span></div>
              </div>
              <div>
                <div class="metric-label">Total maint. kontrak</div>
                <div class="metric-value" id="totalDurationInfo">Rp 0<span>/kontrak</span></div>
              </div>
              <div>
                <div class="metric-label">% OTR / tahun (Normal)</div>
                <div class="metric-value" id="percentYearOtrInfo">0.00%<span>/thn</span></div>
              </div>
              <div>
                <div class="metric-label">Porsi biaya vs project</div>
                <div class="metric-value" id="percentYearProjInfo">0.00%<span>/thn</span></div>
              </div>
            </div>

            <div class="note" id="coreNote">
              Tidak ada perhitungan. Pilih kategori unit & isi harga OTR terlebih dahulu.
            </div>
          </div>
        </div>

        <div class="card" id="newResultBlock">
          <div class="card-header">
            <div>
              <div class="card-title">Unit Baru â€“ 4 Rekomendasi Harga</div>
              <div class="card-sub">Per tahun + estimasi kebutuhan ban selama kontrak.</div>
            </div>
            <div class="tag">New</div>
          </div>

          <div class="results-main blue">
            <table>
              <thead>
              <tr>
                <th>Level</th>
                <th class="num">Service / Thn</th>
                <th class="num">Ban / Thn</th>
                <th class="num">Total / Thn</th>
                <th class="num">% OTR / Thn</th>
                <th class="num">Ban Kontrak (pcs)</th>
              </tr>
              </thead>
              <tbody>
              <tr>
                <td>Normal</td>
                <td class="num" id="newSvcNormal">Rp 0</td>
                <td class="num" id="newTireNormal">Rp 0</td>
                <td class="num" id="newTotalNormal">Rp 0</td>
                <td class="num" id="newPctOtrNormal">0.00%</td>
                <td class="num" id="newTotalNormalDur">0.00 pcs</td>
              </tr>
              <tr>
                <td>Medium</td>
                <td class="num" id="newSvcMedium">Rp 0</td>
                <td class="num" id="newTireMedium">Rp 0</td>
                <td class="num" id="newTotalMedium">Rp 0</td>
                <td class="num" id="newPctOtrMedium">0.00%</td>
                <td class="num" id="newTotalMediumDur">0.00 pcs</td>
              </tr>
              <tr>
                <td>High</td>
                <td class="num" id="newSvcHigh">Rp 0</td>
                <td class="num" id="newTireHigh">Rp 0</td>
                <td class="num" id="newTotalHigh">Rp 0</td>
                <td class="num" id="newPctOtrHigh">0.00%</td>
                <td class="num" id="newTotalHighDur">0.00 pcs</td>
              </tr>
              <tr>
                <td>Very High</td>
                <td class="num" id="newSvcVeryHigh">Rp 0</td>
                <td class="num" id="newTireVeryHigh">Rp 0</td>
                <td class="num" id="newTotalVeryHigh">Rp 0</td>
                <td class="num" id="newPctOtrVeryHigh">0.00%</td>
                <td class="num" id="newTotalVeryHighDur">0.00 pcs</td>
              </tr>
              </tbody>
            </table>

            <div class="note" id="statusNewNote">
              Belum ada perhitungan. Pilih kategori, isi OTR & (opsional) KM/tahun.
            </div>
          </div>
        </div>

        <div class="card" id="usedResultBlock" style="display:none;">
          <div class="card-header">
            <div>
              <div class="card-title">Used Car â€“ Marketing Intelligence</div>
              <div class="card-sub">Biaya rekomendasi per tahun berdasarkan ODO aktual.</div>
            </div>
            <div class="tag">Used</div>
          </div>

          <div class="results-main blue">
            <div class="result-header">
              <div>
                <div class="label-main">Rekomendasi Biaya Tahunan</div>
                <div class="value-main" id="usedTotalOut">Rp 0<span>/tahun</span></div>
              </div>
              <div class="chip blue" id="cpkChip">CPK efektif: -</div>
            </div>

            <table>
              <thead>
              <tr>
                <th>Komponen</th>
                <th class="num">Per Tahun</th>
              </tr>
              </thead>
              <tbody>
              <tr>
                <td>Service (CPK rekomendasi)</td>
                <td class="num" id="usedSvcYear">Rp 0</td>
              </tr>
              <tr>
                <td>Ban</td>
                <td class="num" id="usedTireYear">Rp 0</td>
              </tr>
              <tr>
                <td>Total Maintenance</td>
                <td class="num" id="usedTotalYear">Rp 0</td>
              </tr>
              <tr>
                <td>KM aktual / Tahun</td>
                <td class="num" id="usedKmYear">0 km</td>
              </tr>
              <tr>
                <td>Ban (pcs)</td>
                <td class="num" id="usedTirePcsYear">0.00 pcs</td>
              </tr>
              <tr>
                <td>% OTR / tahun</td>
                <td class="num" id="usedPctOtrYear">0.00%</td>
              </tr>
              </tbody>
            </table>

            <div class="note" id="statusUsedNote">
              Isi ODO & umur unit + OTR. Engine akan hitung km/tahun, level pemakaian, dan % OTR/tahun.
            </div>
          </div>
        </div>

        <div class="card" id="waCard">
          <div class="no-print">
            <div class="card-header">
              <div>
                <div class="card-title">Export Ringkasan (WA)</div>
                <div class="card-sub">Ringkasan singkat untuk internal (marketing / manajemen).</div>
              </div>
              <div class="tag">WA</div>
            </div>
            <div class="field">
              <label for="waText">Ringkasan</label>
              <textarea id="waText" readonly>Isi data dulu, ringkasan akan muncul di sini.</textarea>
            </div>
            <div class="footer">
              <div>
                Angka ini hanya estimasi maintenance support (service &amp; ban).
              </div>
              <div style="display:flex;gap:6px;flex-wrap:wrap;">
                <button type="button" class="btn" id="copyBtn">Copy ke Clipboard</button>
                <button type="button" class="btn" onclick="window.print()">Cetak / PDF</button>
              </div>
            </div>
          </div>

          <div class="signature">
            <div>
              <div>Disusun oleh:</div>
              <div class="sig-name">DADANG WAHYUONO</div>
              <div class="sig-title">Maintenance &amp; Logistic Support</div>
            </div>
            <div class="pdf-hint">
              Catatan: Dokumen ini merupakan pandangan dari sisi maintenance saja (service &amp; ban),
              tanpa memperhitungkan biaya lain di luar itu seperti BBM, driver, asuransi, pajak, dan
              komponen operasional lainnya. Angka ini bukan tarif sewa, tetapi estimasi biaya maintenance
              pendukung untuk membantu keputusan harga sewa & durasi kontrak.
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- TAB 2: TABEL CPK INDUSTRI -->
  <div id="tab-cpk" class="tab-content">
    <div class="cpk-page-card">
      <div class="card-header">
        <div>
          <div class="card-title">Tabel Standar CPK Industri â€“ Nasional</div>
          <div class="card-sub">
            CPK = biaya maintenance per km (service + part kecil + ban). Dipakai sebagai acuan Normal/Medium/High/Very High di kalkulator.
          </div>
        </div>
        <div class="tag">CPK</div>
      </div>

      <table class="cpk-table">
        <thead>
        <tr>
          <th>Kategori Unit</th>
          <th>CPK Normal</th>
          <th>CPK Medium</th>
          <th>CPK High</th>
          <th>CPK Very High</th>
          <th>Keterangan Singkat</th>
        </tr>
        </thead>
        <tbody>
        <tr>
          <td>LCGC / Hatchback (Ayla, Agya, Brio)</td>
          <td>90</td>
          <td>108</td>
          <td>135</td>
          <td>180</td>
          <td>Part kecil, ringan, biaya servis paling rendah.</td>
        </tr>
        <tr>
          <td>MPV Kecil (Avanza, Xenia, Ertiga)</td>
          <td>110</td>
          <td>132</td>
          <td>165</td>
          <td>220</td>
          <td>Mobil operasional paling stabil untuk corporate.</td>
        </tr>
        <tr>
          <td>MPV Medium / Hybrid (Innova, Veloz, Zenix)</td>
          <td>130</td>
          <td>156</td>
          <td>195</td>
          <td>260</td>
          <td>Part lebih mahal, teknologi lebih kompleks.</td>
        </tr>
        <tr>
          <td>SUV / Crossover (HRV, Fortuner, Pajero)</td>
          <td>150</td>
          <td>180</td>
          <td>225</td>
          <td>300</td>
          <td>Biaya service &amp; ban besar, sering di area berat.</td>
        </tr>
        <tr>
          <td>Pickup / Double Cabin (L300, GranMax PU, Hilux)</td>
          <td>140</td>
          <td>168</td>
          <td>210</td>
          <td>280</td>
          <td>Dipakai angkut barang, suspensi &amp; ban cepat habis.</td>
        </tr>
        <tr>
          <td>Light Truck (Engkel â€“ Dutro/Elf 4 roda)</td>
          <td>180</td>
          <td>216</td>
          <td>270</td>
          <td>360</td>
          <td>Beban angkut tinggi, maintenance rem &amp; ban besar.</td>
        </tr>
        <tr>
          <td>Medium Truck (Fuso FM, FE, FN)</td>
          <td>220</td>
          <td>264</td>
          <td>330</td>
          <td>440</td>
          <td>Gearbox, brake, dan suspensi berat.</td>
        </tr>
        <tr>
          <td>Heavy Truck / Tronton / Trailer</td>
          <td>260</td>
          <td>312</td>
          <td>390</td>
          <td>520</td>
          <td>Part raksasa, ban banyak, wear &amp; tear ekstrem.</td>
        </tr>
        </tbody>
      </table>

      <div class="note" style="margin-top:10px;">
        Level pemakaian (Normalâ€“Very High) mengikuti KM/hari:
        Normal â‰¤56 km/hari, Medium 57â€“120, High 121â€“180, Very High &gt;180 km/hari.
        Engine kalkulator menggunakan tabel ini sebagai dasar hitungan otomatis.
      </div>
    </div>
  </div>
</div>

<script>
  const fmt   = new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0});
  const fmtNum= new Intl.NumberFormat("id-ID",{maximumFractionDigits:0});
  const $     = id => document.getElementById(id);
  const num   = v  => {const x=parseFloat(v);return isNaN(x)?0:x;};

  let mode = "new";

  function setMode(m){
    mode = m;
    $("modeNewBtn").classList.toggle("active",m==="new");
    $("modeUsedBtn").classList.toggle("active",m==="used");
    $("newInputBlock").style.display  = m==="new"  ? "" : "none";
    $("newResultBlock").style.display = m==="new"  ? "" : "none";
    $("usedInputBlock").style.display = m==="used" ? "" : "none";
    $("usedResultBlock").style.display= m==="used" ? "" : "none";
    computeAll();
  }

  $("modeNewBtn").addEventListener("click",()=>setMode("new"));
  $("modeUsedBtn").addEventListener("click",()=>setMode("used"));

  $("logoInput").addEventListener("change",e=>{
    const file=e.target.files[0];
    if(!file) return;
    const reader=new FileReader();
    reader.onload=ev=>{$("logoPreview").src=ev.target.result;};
    reader.readAsDataURL(file);
  });

  function getCategoryParams(){
    const cat = $("category").value;
    switch(cat){
      case "lcgc":         return {cpkNormal:90,  tireDefault:650000};
      case "mpv_kecil":    return {cpkNormal:110, tireDefault:900000};
      case "mpv_suv":      return {cpkNormal:130, tireDefault:1200000};
      case "pickup":       return {cpkNormal:140, tireDefault:1100000};
      case "light_truck":  return {cpkNormal:180, tireDefault:1800000};
      case "medium_truck": return {cpkNormal:220, tireDefault:2500000};
      case "heavy_truck":  return {cpkNormal:260, tireDefault:3500000};
      default:             return {cpkNormal:110, tireDefault:900000};
    }
  }

  function getTirePrice(){
    const base=getCategoryParams().tireDefault;
    let p = num($("tirePrice").value);
    if(p<=0) p=base;
    return p;
  }

  function resetCore(){
    $("modeLabel").innerHTML="-<span>Pilih kategori & isi OTR</span>";
    $("kmInfoChip").textContent="KM/tahun: -";
    $("svcCostInfo").innerHTML="Rp 0<span>/thn (Normal)</span>";
    $("tireInfo").innerHTML="0.00 pcs â€¢ Rp 0<span>/thn</span>";
    $("totalYearInfo").innerHTML="Rp 0<span>/thn (Normal)</span>";
    $("cpkResultInfo").innerHTML="-<span>Rp/km (Normal)</span>";
    $("totalKmDurationInfo").innerHTML="0 km<span>/kontrak</span>";
    $("totalDurationInfo").innerHTML="Rp 0<span>/kontrak</span>";
    $("percentYearOtrInfo").innerHTML="0.00%<span>/thn</span>";
    $("percentYearProjInfo").innerHTML="0.00%<span>/thn</span>";
    $("coreNote").textContent="Tidak ada perhitungan. Pilih kategori unit & isi harga OTR terlebih dahulu.";
    if($("pdfUnitInfo")) $("pdfUnitInfo").textContent="Unit: - â€¢ OTR: Rp 0";
    if($("headerUnitInfo")) $("headerUnitInfo").textContent="Unit: - â€¢ OTR: Rp 0";
  }

  function resetNewTable(){
    ["newSvcNormal","newTireNormal","newTotalNormal",
     "newSvcMedium","newTireMedium","newTotalMedium",
     "newSvcHigh","newTireHigh","newTotalHigh",
     "newSvcVeryHigh","newTireVeryHigh","newTotalVeryHigh"
    ].forEach(id=>{$(id).textContent="Rp 0";});
    ["newPctOtrNormal","newPctOtrMedium","newPctOtrHigh","newPctOtrVeryHigh"]
      .forEach(id=>{$(id).textContent="0.00%";});
    ["newTotalNormalDur","newTotalMediumDur","newTotalHighDur","newTotalVeryHighDur"]
      .forEach(id=>{$(id).textContent="0.00 pcs";});
    $("statusNewNote").textContent="Belum ada perhitungan. Pilih kategori, isi OTR & (opsional) KM/tahun.";
    $("waText").value="Isi data dulu, ringkasan akan muncul di sini.";
  }

  function resetUsedTable(){
    $("usedTotalOut").innerHTML="Rp 0<span>/tahun</span>";
    ["usedSvcYear","usedTireYear","usedTotalYear"]
      .forEach(id=>{$(id).textContent="Rp 0";});
    $("usedKmYear").textContent="0 km";
    $("usedTirePcsYear").textContent="0.00 pcs";
    $("usedPctOtrYear").textContent="0.00%";
    $("cpkChip").textContent="CPK efektif: -";
    $("statusUsedNote").textContent=
      "Isi ODO & umur unit + OTR. Engine akan hitung km/tahun, level pemakaian, dan % OTR/tahun.";
    $("waText").value="Isi data dulu, ringkasan akan muncul di sini.";
  }

  function computeAll(){
    const unitName   = $("unitName").value || "-";
    const otr        = num($("otr").value);
    const projectVal = num($("projectValue").value);
    const tirePrice  = getTirePrice();
    const years      = num($("duration").value) || 1;
    const cat        = $("category").value;

    if(!cat || otr<=0){
      resetCore();
      resetNewTable();
      resetUsedTable();
      return;
    }

    const catText = $("category").options[$("category").selectedIndex].text;
    if($("pdfUnitInfo"))
      $("pdfUnitInfo").textContent   = "Unit: "+unitName+" ("+catText+") â€¢ OTR: "+fmt.format(otr||0);
    if($("headerUnitInfo"))
      $("headerUnitInfo").textContent= "Unit: "+unitName+" ("+catText+") â€¢ OTR: "+fmt.format(otr||0);

    const {cpkNormal} = getCategoryParams();

    if(mode==="new"){
      const kmInput = num($("kmYearNew").value);
      const kmYear  = kmInput>0 ? kmInput : 20000;

      const cpkMed       = cpkNormal*1.2;
      const cpkHigh      = cpkNormal*1.5;
      const cpkVeryHigh  = cpkNormal*2.0;

      const banPcsYear   = kmYear/50000;
      const banCostYear  = banPcsYear*tirePrice;

      const svcYearNormal    = cpkNormal*kmYear;
      const svcYearMedium    = cpkMed*kmYear;
      const svcYearHigh      = cpkHigh*kmYear;
      const svcYearVeryHigh  = cpkVeryHigh*kmYear;

      const totalYearNormal  = svcYearNormal+banCostYear;
      const totalYearMedium  = svcYearMedium+banCostYear;
      const totalYearHigh    = svcYearHigh+banCostYear;
      const totalYearVeryHigh= svcYearVeryHigh+banCostYear;

      const totalKmDur       = kmYear*years;
      const totalBanPcsDur   = banPcsYear*years;
      const totalNormalDur   = totalYearNormal*years;

      const cpkTotalNormal   = kmYear>0 ? totalYearNormal/kmYear : 0;

      const pctOtrNorm = otr>0 ? (totalYearNormal/otr*100) : 0;
      const pctOtrMed  = otr>0 ? (totalYearMedium/otr*100) : 0;
      const pctOtrHigh = otr>0 ? (totalYearHigh/otr*100) : 0;
      const pctOtrVh   = otr>0 ? (totalYearVeryHigh/otr*100) : 0;

      const projPerYear = projectVal>0 && years>0 ? projectVal/years : 0;
      const pctProjNorm = projPerYear>0 ? (totalYearNormal/projPerYear*100) : 0;

      $("modeLabel").innerHTML="UNIT BARU<span>(CPK Otomatis & KM/tahun)</span>";
      $("kmInfoChip").textContent="KM/tahun: "+fmtNum.format(Math.round(kmYear));
      $("svcCostInfo").innerHTML=fmt.format(svcYearNormal||0)+"<span>/thn (Normal)</span>";
      $("tireInfo").innerHTML=banPcsYear.toFixed(2)+" pcs â€¢ "+fmt.format(banCostYear||0)+"<span>/thn</span>";
      $("totalYearInfo").innerHTML=fmt.format(totalYearNormal||0)+"<span>/thn (Normal)</span>";
      $("cpkResultInfo").innerHTML=(cpkTotalNormal>0?fmt.format(cpkTotalNormal).replace(",00",""):"-")+"<span>Rp/km (Normal)</span>";
      $("totalKmDurationInfo").innerHTML=fmtNum.format(Math.round(totalKmDur||0))+" km<span>/kontrak</span>";
      $("totalDurationInfo").innerHTML=fmt.format(totalNormalDur||0)+"<span>/kontrak (Normal)</span>";
      $("percentYearOtrInfo").innerHTML=pctOtrNorm.toFixed(2)+"%<span>/thn</span>";
      $("percentYearProjInfo").innerHTML=pctProjNorm.toFixed(2)+"%<span>/thn</span>";

      $("newSvcNormal").textContent=fmt.format(svcYearNormal||0);
      $("newTireNormal").textContent=fmt.format(banCostYear||0);
      $("newTotalNormal").textContent=fmt.format(totalYearNormal||0);
      $("newPctOtrNormal").textContent=pctOtrNorm.toFixed(2)+"%";
      $("newTotalNormalDur").textContent=totalBanPcsDur.toFixed(2)+" pcs";

      $("newSvcMedium").textContent=fmt.format(svcYearMedium||0);
      $("newTireMedium").textContent=fmt.format(banCostYear||0);
      $("newTotalMedium").textContent=fmt.format(totalYearMedium||0);
      $("newPctOtrMedium").textContent=pctOtrMed.toFixed(2)+"%";
      $("newTotalMediumDur").textContent=totalBanPcsDur.toFixed(2)+" pcs";

      $("newSvcHigh").textContent=fmt.format(svcYearHigh||0);
      $("newTireHigh").textContent=fmt.format(banCostYear||0);
      $("newTotalHigh").textContent=fmt.format(totalYearHigh||0);
      $("newPctOtrHigh").textContent=pctOtrHigh.toFixed(2)+"%";
      $("newTotalHighDur").textContent=totalBanPcsDur.toFixed(2)+" pcs";

      $("newSvcVeryHigh").textContent=fmt.format(svcYearVeryHigh||0);
      $("newTireVeryHigh").textContent=fmt.format(banCostYear||0);
      $("newTotalVeryHigh").textContent=fmt.format(totalYearVeryHigh||0);
      $("newPctOtrVeryHigh").textContent=pctOtrVh.toFixed(2)+"%";
      $("newTotalVeryHighDur").textContent=totalBanPcsDur.toFixed(2)+" pcs";

      let status="";
      if(pctOtrNorm<=0){
        status="Belum bisa menilai %OTR (data belum lengkap).";
      }else if(pctOtrNorm<1){
        status="Level Normal â‰ˆ "+pctOtrNorm.toFixed(2)+"% dari OTR per tahun â†’ di bawah batas 1%. Proyek ini bagus dari sisi maintenance.";
      }else if(pctOtrNorm<=1.2){
        status="Level Normal â‰ˆ "+pctOtrNorm.toFixed(2)+"% dari OTR per tahun â†’ sedikit di atas 1%. Disarankan marketing memperpanjang durasi sewa atau menyesuaikan harga sewa.";
      }else{
        status="Level Normal â‰ˆ "+pctOtrNorm.toFixed(2)+"% dari OTR per tahun â†’ jauh di atas 1%. Kontrak berisiko rugi dari sisi maintenance; perlu negosiasi ulang durasi / harga.";
      }
      $("statusNewNote").textContent=status;

      const lines=[];
      lines.push("ðŸ§® Maintenance Support â€“ UNIT BARU (CPK Otomatis)");
      lines.push("");
      lines.push("Unit       : "+unitName);
      lines.push("Kategori   : "+catText);
      lines.push("OTR        : "+fmt.format(otr||0));
      if(projectVal>0) lines.push("Nilai proj : "+fmt.format(projectVal||0));
      lines.push("Durasi     : "+years+" tahun");
      lines.push("");
      lines.push("KM/tahun   : "+fmtNum.format(Math.round(kmYear))+" km");
      lines.push("");
      lines.push("Biaya/tahun (Normal)  : "+fmt.format(totalYearNormal||0)+"  ("+pctOtrNorm.toFixed(2)+"% OTR)");
      lines.push("Rekomendasi lain /thn :");
      lines.push("- Medium    : "+fmt.format(totalYearMedium||0)+"  ("+pctOtrMed.toFixed(2)+"% OTR)");
      lines.push("- High      : "+fmt.format(totalYearHigh||0)+"  ("+pctOtrHigh.toFixed(2)+"% OTR)");
      lines.push("- VeryHigh  : "+fmt.format(totalYearVeryHigh||0)+"  ("+pctOtrVh.toFixed(2)+"% OTR)");
      lines.push("");
      lines.push("Catatan internal: batas maintenance ideal â‰ˆ1% OTR per tahun. Normal "+pctOtrNorm.toFixed(2)+"% â†’ "+status);
      $("waText").value=lines.join("\n");

      $("coreNote").textContent=
        "Batas internal: biaya maintenance Normal â‰ˆ "+pctOtrNorm.toFixed(2)+
        "% dari OTR per tahun. Di bawah 1% â†’ proyek bagus. Di atas 1% â†’ marketing perlu adjust durasi/harga sewa.";

    }else{
      const odo = num($("odo").value);
      const age = num($("unitAge").value);

      if(odo<=0 || age<=0){
        resetUsedTable();
        resetCore();
        $("coreNote").textContent="Isi ODO, umur unit, kategori & OTR untuk perhitungan used car.";
        return;
      }

      const kmYearActual = odo/age;
      const kmPerDay     = kmYearActual/365;

      let faktor=1, levelText="Normal";
      if(kmPerDay<=56){faktor=1;levelText="Normal";}
      else if(kmPerDay<=120){faktor=1.2;levelText="Medium";}
      else if(kmPerDay<=180){faktor=1.5;levelText="High";}
      else{faktor=2.0;levelText="Very High";}

      const {cpkNormal} = getCategoryParams();

      const svcCostYear   = cpkNormal*faktor*kmYearActual;
      const banPcsYear    = kmYearActual/50000;
      const banCostYear   = banPcsYear*tirePrice;
      const totalMaintYear= svcCostYear+banCostYear;
      const totalMaintDur = totalMaintYear*years;
      const totalKmDur    = kmYearActual*years;

      const cpkEffective  = kmYearActual>0 ? totalMaintYear/kmYearActual : 0;

      const pctOtrYear = otr>0 ? (totalMaintYear/otr*100) : 0;
      const projPerYear= projectVal>0 && years>0 ? projectVal/years : 0;
      const pctProjYear= projPerYear>0 ? (totalMaintYear/projPerYear*100) : 0;

      $("modeLabel").innerHTML="USED CAR<span>(Marketing Intelligence)</span>";
      $("kmInfoChip").textContent="KM/tahun: "+fmtNum.format(Math.round(kmYearActual||0))+" ("+levelText+")";
      $("svcCostInfo").innerHTML=fmt.format(svcCostYear||0)+"<span>/thn (Rekomendasi)</span>";
      $("tireInfo").innerHTML=banPcsYear.toFixed(2)+" pcs â€¢ "+fmt.format(banCostYear||0)+"<span>/thn</span>";
      $("totalYearInfo").innerHTML=fmt.format(totalMaintYear||0)+"<span>/thn (Rekomendasi)</span>";
      $("cpkResultInfo").innerHTML=(cpkEffective>0?fmt.format(cpkEffective).replace(",00",""):"-")+"<span>Rp/km (Efektif)</span>";
      $("totalKmDurationInfo").innerHTML=fmtNum.format(Math.round(totalKmDur||0))+" km<span>/kontrak</span>";
      $("totalDurationInfo").innerHTML=fmt.format(totalMaintDur||0)+"<span>/kontrak</span>";
      $("percentYearOtrInfo").innerHTML=pctOtrYear.toFixed(2)+"%<span>/thn</span>";
      $("percentYearProjInfo").innerHTML=pctProjYear.toFixed(2)+"%<span>/thn</span>";

      $("usedTotalOut").innerHTML=fmt.format(totalMaintYear||0)+"<span>/tahun</span>";
      $("usedSvcYear").textContent=fmt.format(svcCostYear||0);
      $("usedTireYear").textContent=fmt.format(banCostYear||0);
      $("usedTotalYear").textContent=fmt.format(totalMaintYear||0);
      $("usedKmYear").textContent=fmtNum.format(Math.round(kmYearActual||0))+" km";
      $("usedTirePcsYear").textContent=banPcsYear.toFixed(2)+" pcs";
      $("usedPctOtrYear").textContent=pctOtrYear.toFixed(2)+"%";

      $("cpkChip").textContent= cpkEffective>0
        ? "CPK efektif: "+fmt.format(cpkEffective).replace(",00","")+"/km ("+levelText+")"
        : "CPK efektif: -";

      let status="";
      if(pctOtrYear<=0){
        status="Belum bisa menilai %OTR (data belum lengkap).";
      }else if(pctOtrYear<1){
        status="Biaya maintenance â‰ˆ "+pctOtrYear.toFixed(2)+"% dari OTR per tahun â†’ di bawah batas 1%. Proyek masih aman dari sisi maintenance.";
      }else if(pctOtrYear<=1.2){
        status="Biaya maintenance â‰ˆ "+pctOtrYear.toFixed(2)+"% dari OTR per tahun â†’ sedikit di atas 1%. Disarankan marketing menambah durasi sewa atau menyesuaikan harga sewa.";
      }else{
        status="Biaya maintenance â‰ˆ "+pctOtrYear.toFixed(2)+"% dari OTR per tahun â†’ jauh di atas 1%. Kontrak berisiko rugi, perlu negosiasi pricing/durasi.";
      }
      $("statusUsedNote").textContent=status;

      const lines=[];
      lines.push("ðŸ§® Maintenance Support â€“ USED CAR");
      lines.push("");
      lines.push("Unit       : "+unitName);
      lines.push("Kategori   : "+catText);
      lines.push("OTR        : "+fmt.format(otr||0));
      if(projectVal>0) lines.push("Nilai proj : "+fmt.format(projectVal||0));
      lines.push("Durasi (referensi OTR) : "+years+" tahun");
      lines.push("");
      lines.push("ODO        : "+fmtNum.format(odo||0)+" km");
      lines.push("Umur unit  : "+(age||0)+" tahun");
      lines.push("KM/tahun   : "+fmtNum.format(Math.round(kmYearActual||0))+" km ("+levelText+")");
      lines.push("");
      lines.push("Biaya/tahun (rekomendasi) : "+fmt.format(totalMaintYear||0)+"  ("+pctOtrYear.toFixed(2)+"% OTR)");
      lines.push("");
      lines.push("Catatan internal: batas maintenance ideal â‰ˆ1% OTR per tahun. "+status);
      $("waText").value=lines.join("\n");

      $("coreNote").textContent=
        "Used car: biaya maintenance â‰ˆ "+pctOtrYear.toFixed(2)+
        "% dari OTR per tahun. Di bawah 1% â†’ bagus. Di atas 1% â†’ marketing perlu adjust durasi/harga sewa.";
    }
  }

  ["unitName","otr","projectValue","tirePrice","tireQty",
   "kmYearNew","odo","unitAge","duration","category"].forEach(id=>{
    $(id).addEventListener("input",computeAll);
    $(id).addEventListener("change",computeAll);
  });

  $("copyBtn").addEventListener("click",async()=>{
    try{
      await navigator.clipboard.writeText($("waText").value||"");
      $("copyBtn").textContent="Copied!";
      setTimeout(()=>{$("copyBtn").textContent="Copy ke Clipboard";},1200);
    }catch{
      $("copyBtn").textContent="Gagal copy";
      setTimeout(()=>{$("copyBtn").textContent="Copy ke Clipboard";},1500);
    }
  });

  // Tabs switch
  document.querySelectorAll(".tab-btn").forEach(btn=>{
    btn.addEventListener("click",()=>{
      document.querySelectorAll(".tab-btn").forEach(b=>b.classList.remove("active"));
      btn.classList.add("active");
      const tab = btn.getAttribute("data-tab");
      document.querySelectorAll(".tab-content").forEach(c=>c.classList.remove("active"));
      $("tab-"+tab).classList.add("active");
    });
  });

  resetCore();
  resetNewTable();
  resetUsedTable();
</script>
</body>
</html>
